# Hyperparameter-Search for PEFT Methods

## LoRA

## LoRA Scaling Factor study on OrgaSegment

Run LoRA finetuning with learning rate 1e-5 on Orgasegment, where $r \in [1, 2, 4, 8, 16, 32, 64]$ and $\alpha \in [1, 2, 4]$

|   alpha |   rank |      ais |   single box |   single point |       ib |       ip |
|--------:|-------:|---------:|-------------:|---------------:|---------:|---------:|
|       1 |      1 | 0.46768  |     0.785293 |       0.439386 | 0.866108 | 0.834264 |
|       1 |      2 | 0.471911 |     0.786374 |       0.433548 | 0.866435 | 0.827245 |
|       1 |      4 | 0.45655  |     0.786528 |       0.425875 | 0.868739 | 0.833975 |
|       1 |      8 | 0.457918 |     0.790174 |       0.46141  | 0.870779 | 0.835133 |
|       1 |     16 | 0.457208 |     0.789676 |       0.466306 | 0.871321 | 0.823999 |
|       1 |     32 | 0.488162 |     0.782712 |       0.448029 | 0.873318 | 0.841033 |
|       1 |     64 | 0.466878 |     0.786976 |       0.472517 | 0.870267 | 0.828985 |
|       2 |      1 | 0.463527 |     0.790652 |       0.436301 | 0.866287 | 0.831002 |
|       2 |      2 | 0.473062 |     0.780874 |       0.420014 | 0.864773 | 0.823518 |
|       2 |      4 | 0.483536 |     0.788871 |       0.458526 | 0.864075 | 0.834208 |
|       2 |      8 | 0.463814 |     0.792031 |       0.449655 | 0.869159 | 0.832825 |
|       2 |     16 | 0.458602 |     0.788588 |       0.471989 | 0.868308 | 0.81852  |
|       2 |     32 | 0.466547 |     0.791587 |       0.472539 | 0.853976 | 0.830419 |
|       2 |     64 | 0.467031 |     0.78799  |       0.475689 | 0.8659   | 0.835546 |
|       4 |      1 | 0.459899 |     0.790665 |       0.438623 | 0.861225 | 0.835481 |
|       4 |      2 | 0.470808 |     0.791318 |       0.430144 | 0.863609 | 0.838067 |
|       4 |      4 | 0.464572 |     0.790739 |       0.464787 | 0.874642 | 0.832083 |
|       4 |      8 | 0.47509  |     0.779162 |       0.461385 | 0.857567 | 0.82316  |
|       4 |     16 | 0.464848 |     0.788842 |       0.472459 | 0.868851 | 0.835807 |
|       4 |     32 | 0.460883 |     0.78711  |       0.469901 | 0.869068 | 0.841081 |
|       4 |     64 | 0.500449 |     0.774742 |       0.447817 | 0.860343 | 0.833205 |

Run LoRA finetuning on OrgaSegment data with $r \in [1, 32], \alpha \in [1, 2, 4]$ and learning rate $\in [1e-3, 5e-4, 1e-4, 5e-5, 1e-5]$

|     lr |   alpha |   rank |      ais |   single box |   single point |       ib |       ip |
|-------:|--------:|-------:|---------:|-------------:|---------------:|---------:|---------:|
| 0.001  |       1 |      1 | 0.442127 |     0.654549 |       0.449638 | 0.71335  | 0.672442 |
| 0.0005 |       1 |      1 | 0.447397 |     0.685428 |       0.474276 | 0.787298 | 0.752919 |
| 0.0001 |       1 |      1 | 0.454513 |     0.781788 |       0.450372 | 0.858663 | 0.818236 |
| 5e-05  |       1 |      1 | 0.449267 |     0.777703 |       0.429012 | 0.850412 | 0.826203 |
| 1e-05  |       1 |      1 | 0.46768  |     0.785293 |       0.439386 | 0.866108 | 0.834264 |
| 0.001  |       1 |     32 | 0.462965 |     0.644866 |       0.447835 | 0.722589 | 0.677151 |
| 0.0005 |       1 |     32 | 0.463994 |     0.71032  |       0.450568 | 0.790268 | 0.761013 |
| 0.0001 |       1 |     32 | 0.450451 |     0.768767 |       0.480264 | 0.852866 | 0.827818 |
| 5e-05  |       1 |     32 | 0.450311 |     0.783481 |       0.451521 | 0.868696 | 0.837526 |
| 1e-05  |       1 |     32 | 0.488162 |     0.782712 |       0.448029 | 0.873318 | 0.841033 |
| 0.001  |       2 |      1 | 0.431478 |     0.672087 |       0.452457 | 0.72659  | 0.691971 |
| 0.0005 |       2 |      1 | 0.45154  |     0.729186 |       0.449041 | 0.818687 | 0.785655 |
| 0.0001 |       2 |      1 | 0.44185  |     0.781901 |       0.47002  | 0.859553 | 0.828746 |
| 5e-05  |       2 |      1 | 0.433222 |     0.785949 |       0.460107 | 0.867836 | 0.836559 |
| 1e-05  |       2 |      1 | 0.463527 |     0.790652 |       0.436301 | 0.866287 | 0.831002 |
| 0.001  |       2 |     32 | 0.464313 |     0.660461 |       0.421702 | 0.733176 | 0.685167 |
| 0.0005 |       2 |     32 | 0.457296 |     0.707891 |       0.456575 | 0.801023 | 0.766612 |
| 0.0001 |       2 |     32 | 0.451915 |     0.766322 |       0.494126 | 0.852293 | 0.819615 |
| 5e-05  |       2 |     32 | 0.45357  |     0.77835  |       0.481603 | 0.863029 | 0.829468 |
| 1e-05  |       2 |     32 | 0.466547 |     0.791587 |       0.472539 | 0.853976 | 0.830419 |
| 0.001  |       4 |      1 | 0.431053 |     0.66506  |       0.454513 | 0.741279 | 0.702872 |
| 0.0005 |       4 |      1 | 0.452152 |     0.718695 |       0.485151 | 0.808962 | 0.777798 |
| 0.0001 |       4 |      1 | 0.453585 |     0.770095 |       0.477717 | 0.847284 | 0.823555 |
| 5e-05  |       4 |      1 | 0.451519 |     0.781282 |       0.472472 | 0.863617 | 0.830746 |
| 1e-05  |       4 |      1 | 0.459899 |     0.790665 |       0.438623 | 0.861225 | 0.835481 |
| 0.001  |       4 |     32 | 0.3129   |     0.634085 |       0.213877 | 0.755184 | 0.663602 |
| 0.0005 |       4 |     32 | 0.458208 |     0.701473 |       0.470512 | 0.799344 | 0.739338 |
| 0.0001 |       4 |     32 | 0.478745 |     0.758938 |       0.495485 | 0.842157 | 0.817848 |
| 5e-05  |       4 |     32 | 0.449575 |     0.777866 |       0.49166  | 0.866549 | 0.831833 |
| 1e-05  |       4 |     32 | 0.460883 |     0.78711  |       0.469901 | 0.869068 | 0.841081 |

Run LoRA finetuning on OrgaSegment data with fixed learning rate and rank and $\alpha \in [0.1, 0.25, 0.5, 0.75, 1, 2, 4]$

|    lr |   alpha |   rank |      ais |   single box |   single point |       ib |       ip |
|------:|--------:|-------:|---------:|-------------:|---------------:|---------:|---------:|
| 1e-05 |    0.1  |     32 | 0.469089 |     0.788318 |       0.446878 | 0.866802 | 0.834757 |
| 1e-05 |    0.25 |     32 | 0.453937 |     0.789443 |       0.452305 | 0.864315 | 0.826986 |
| 1e-05 |    0.5  |     32 | 0.465209 |     0.791018 |       0.468178 | 0.868814 | 0.834729 |
| 1e-05 |    0.75 |     32 | 0.456791 |     0.790985 |       0.463087 | 0.870032 | 0.833676 |
| 1e-05 |    1    |     32 | 0.488162 |     0.782712 |       0.448029 | 0.873318 | 0.841033 |
| 1e-05 |    2    |     32 | 0.466547 |     0.791587 |       0.472539 | 0.853976 | 0.830419 |
| 1e-05 |    4    |     32 | 0.460883 |     0.78711  |       0.469901 | 0.869068 | 0.841081 |

Run LoRA finetuning for different $\alpha$ on 4 datasets

|    | dataset                   | base model          |    lr |   alpha |   rank |       ais |   single box |   single point |       ib |       ip |
|---:|:--------------------------|:--------------------|------:|--------:|-------:|----------:|-------------:|---------------:|---------:|---------:|
|  0 | mitolab_glycolytic_muscle | vit_b               | 1e-05 |     0.1 |     32 | 0.536482  |     0.829835 |      0.50413   | 0.916881 | 0.883716 |
|  1 | mitolab_glycolytic_muscle | vit_b_em_organelles | 1e-05 |     0.1 |     32 | 0.556107  |     0.853912 |      0.557023  | 0.961272 | 0.934695 |
|  2 | mitolab_glycolytic_muscle | vit_b               | 1e-05 |     1   |     32 | 0.497071  |     0.835574 |      0.51083   | 0.939603 | 0.910961 |
|  3 | mitolab_glycolytic_muscle | vit_b_em_organelles | 1e-05 |     1   |     32 | 0.554083  |     0.853403 |      0.559253  | 0.95771  | 0.937766 |
|  4 | mitolab_glycolytic_muscle | vit_b               | 1e-05 |     8   |     32 | 0.513593  |     0.835774 |      0.578662  | 0.943362 | 0.916792 |
|  5 | mitolab_glycolytic_muscle | vit_b_em_organelles | 1e-05 |     8   |     32 | 0.551239  |     0.844301 |      0.578505  | 0.955791 | 0.932146 |
|  6 | platy_cilia               | vit_b               | 1e-05 |     0.1 |     32 | 0.151411  |     0.345254 |      0.0713832 | 0.497421 | 0.412838 |
|  7 | platy_cilia               | vit_b_em_organelles | 1e-05 |     0.1 |     32 | 0.192314  |     0.356508 |      0.0882952 | 0.503409 | 0.429298 |
|  8 | platy_cilia               | vit_b               | 1e-05 |     1   |     32 | 0.22683   |     0.344947 |      0.0600983 | 0.488757 | 0.398777 |
|  9 | platy_cilia               | vit_b_em_organelles | 1e-05 |     1   |     32 | 0.22023   |     0.360744 |      0.0854326 | 0.497348 | 0.413515 |
| 10 | platy_cilia               | vit_b               | 1e-05 |     8   |     32 | 0.163476  |     0.344507 |      0.061699  | 0.480519 | 0.386278 |
| 11 | platy_cilia               | vit_b_em_organelles | 1e-05 |     8   |     32 | 0.242538  |     0.358575 |      0.075714  | 0.484506 | 0.414609 |
| 12 | orgasegment               | vit_b               | 1e-05 |     0.1 |     32 | 0.42312   |     0.764924 |      0.454048  | 0.833147 | 0.818195 |
| 13 | orgasegment               | vit_b_lm            | 1e-05 |     0.1 |     32 | 0.454608  |     0.789355 |      0.432341  | 0.868184 | 0.825515 |
| 14 | orgasegment               | vit_b               | 1e-05 |     1   |     32 | 0.445006  |     0.741813 |      0.460762  | 0.819931 | 0.783847 |
| 15 | orgasegment               | vit_b_lm            | 1e-05 |     1   |     32 | 0.482907  |     0.782219 |      0.432485  | 0.864652 | 0.826577 |
| 16 | orgasegment               | vit_b               | 1e-05 |     8   |     32 | 0.435651  |     0.767563 |      0.495964  | 0.846368 | 0.818146 |
| 17 | orgasegment               | vit_b_lm            | 1e-05 |     8   |     32 | 0.463553  |     0.788235 |      0.482398  | 0.87165  | 0.836468 |
| 18 | covid_if                  | vit_b               | 1e-05 |     0.1 |     32 | 0.0762899 |     0.525831 |      0.0350987 | 0.70928  | 0.593391 |
| 19 | covid_if                  | vit_b_lm            | 1e-05 |     0.1 |     32 | 0.211631  |     0.602903 |      0.135438  | 0.823366 | 0.742739 |
| 20 | covid_if                  | vit_b               | 1e-05 |     1   |     32 | 0.0828777 |     0.540668 |      0.0358469 | 0.727102 | 0.6173   |
| 21 | covid_if                  | vit_b_lm            | 1e-05 |     1   |     32 | 0.194313  |     0.60419  |      0.116511  | 0.825754 | 0.744552 |
| 22 | covid_if                  | vit_b               | 1e-05 |     8   |     32 | 0.0897083 |     0.542643 |      0.0469611 | 0.732776 | 0.610535 |
| 23 | covid_if                  | vit_b_lm            | 1e-05 |     8   |     32 | 0.186255  |     0.601711 |      0.107921  | 0.824447 | 0.743293 |


## AdaptFormer
on OrgaSegment

| alpha            | projection size | dropout | ais      | single box | single point | ib       | ip       |
|-------------------|-----------------|---------|----------|------------|--------------|----------|----------|
| 0.1              | 64              | 0.10    | 0.449775 | 0.780846   | 0.406509     | 0.863958 | 0.826215 |
| 0.1              | 64              | 0.25    | 0.455506 | 0.779486   | 0.398404     | 0.870664 | 0.824370 |
| 0.1              | 64              | 0.50    | 0.442231 | 0.778940   | 0.405831     | 0.865278 | 0.826771 |
| 0.1              | 64              | NaN     | 0.445694 | 0.779905   | 0.396324     | 0.867949 | 0.827388 |
| 0.1              | 128             | 0.10    | 0.452643 | 0.782152   | 0.416546     | 0.869964 | 0.830455 |
| 0.1              | 128             | 0.25    | 0.445529 | 0.781065   | 0.409401     | 0.871320 | 0.823228 |
| 0.1              | 128             | 0.50    | 0.448284 | 0.781307   | 0.409283     | 0.865906 | 0.832287 |
| 0.1              | 128             | NaN     | 0.457911 | 0.780204   | 0.415741     | 0.867117 | 0.831854 |
| 0.1              | 256             | 0.10    | 0.462547 | 0.779460   | 0.412560     | 0.863955 | 0.829901 |
| 0.1              | 256             | 0.25    | 0.456738 | 0.781847   | 0.410703     | 0.868515 | 0.821476 |
| 0.1              | 256             | 0.50    | 0.447895 | 0.783087   | 0.409468     | 0.868205 | 0.831784 |
| 0.1              | 256             | NaN     | 0.467876 | 0.783575   | 0.414095     | 0.864715 | 0.832036 |
| 0.5              | 64              | 0.10    | 0.469403 | 0.775023   | 0.429028     | 0.858429 | 0.815022 |
| 0.5              | 64              | 0.25    | 0.447605 | 0.784368   | 0.407158     | 0.865962 | 0.828487 |
| 0.5              | 64              | 0.50    | 0.466523 | 0.775191   | 0.408845     | 0.866996 | 0.830499 |
| 0.5              | 64              | NaN     | 0.451771 | 0.781907   | 0.417375     | 0.862908 | 0.830674 |
| 0.5              | 128             | 0.10    | 0.470927 | 0.782061   | 0.426264     | 0.868410 | 0.827913 |
| 0.5              | 128             | 0.25    | 0.457688 | 0.783020   | 0.420498     | 0.866706 | 0.829054 |
| 0.5              | 128             | 0.50    | 0.462434 | 0.785488   | 0.415019     | 0.870767 | 0.828489 |
| 0.5              | 128             | NaN     | 0.457969 | 0.786941   | 0.422271     | 0.863463 | 0.836558 |
| 0.5              | 256             | 0.10    | 0.455342 | 0.781589   | 0.417726     | 0.865755 | 0.833959 |
| 0.5              | 256             | 0.25    | 0.451207 | 0.787905   | 0.422775     | 0.858372 | 0.829641 |
| 0.5              | 256             | 0.50    | 0.452536 | 0.784501   | 0.423938     | 0.860874 | 0.832861 |
| 0.5              | 256             | NaN     | 0.457914 | 0.779051   | 0.404883     | 0.863981 | 0.820696 |
| 1                | 64              | 0.10    | 0.466396 | 0.780120   | 0.398364     | 0.865867 | 0.830004 |
| 1                | 64              | 0.25    | 0.441007 | 0.785096   | 0.424754     | 0.867595 | 0.833486 |
| 1                | 64              | 0.50    | 0.464196 | 0.778841   | 0.421792     | 0.863810 | 0.832000 |
| 1                | 64              | NaN     | 0.461033 | 0.779288   | 0.434156     | 0.861762 | 0.825761 |
| 1                | 128             | 0.10    | 0.454299 | 0.785008   | 0.428287     | 0.866846 | 0.836109 |
| 1                | 128             | 0.25    | 0.449516 | 0.782266   | 0.403456     | 0.861967 | 0.828018 |
| 1                | 128             | 0.50    | 0.460772 | 0.784705   | 0.414051     | 0.861976 | 0.836445 |
| 1                | 128             | NaN     | 0.454369 | 0.784876   | 0.427397     | 0.862948 | 0.828802 |
| 1                | 256             | 0.10    | 0.451954 | 0.787745   | 0.445592     | 0.868861 | 0.829971 |
| 1                | 256             | 0.25    | 0.471467 | 0.784002   | 0.446628     | 0.867955 | 0.831308 |
| 1                | 256             | 0.50    | 0.454279 | 0.783308   | 0.438264     | 0.863873 | 0.836605 |
| 1                | 256             | NaN     | 0.459942 | 0.783490   | 0.431017     | 0.865126 | 0.831750 |
| learnable_scalar | 64              | 0.10    | 0.454497 | 0.782099   | 0.421201     | 0.865129 | 0.826767 |
| learnable_scalar | 64              | 0.25    | 0.451371 | 0.784835   | 0.423064     | 0.868386 | 0.828864 |
| learnable_scalar | 64              | 0.50    | 0.455458 | 0.783823   | 0.412940     | 0.868943 | 0.830359 |
| learnable_scalar | 64              | NaN     | 0.452237 | 0.785005   | 0.427526     | 0.865163 | 0.831715 |
| learnable_scalar | 128             | 0.10    | 0.449651 | 0.787646   | 0.425933     | 0.869031 | 0.831707 |
| learnable_scalar | 128             | 0.25    | 0.463117 | 0.785254   | 0.428860     | 0.866320 | 0.832496 |


## FacT
on LiveCELL
| dropout factor|      ais |      amg |       ip |       ib |    point |      box |
|:------------|---------:|---------:|---------:|---------:|---------:|---------:|
|        0.25 | 0.386388 | 0.26497  | 0.783651 | 0.82816  | 0.40846  | 0.64648  |
|        None | 0.383379 | 0.256524 | 0.779622 | 0.822782 | 0.400679 | 0.64233  |
|        0.1  | 0.38944  | 0.265567 | 0.787556 | 0.830561 | 0.413252 | 0.649592 |
|        0.5  | 0.385142 | 0.2589   | 0.77919  | 0.821817 | 0.397363 | 0.640852 |

| Rank        |      ais |      amg |       ip |       ib |    point |      box |
|:------------|---------:|---------:|---------:|---------:|---------:|---------:|
| 1           | 0.379699 | 0.236793 | 0.774329 | 0.822471 | 0.382696 | 0.630324 |
| 2           | 0.383812 | 0.243725 | 0.775398 | 0.822041 | 0.38733  | 0.63805  |
| 4           | 0.38944  | 0.265567 | 0.787556 | 0.830561 | 0.413252 | 0.649592 |
| 8           | 0.393855 | 0.268637 | 0.78339  | 0.826328 | 0.415375 | 0.648752 |
| 16          | 0.3986   | 0.281944 | 0.792422 | 0.833112 | 0.426964 | 0.655786 |
| 32          | 0.397353 | 0.288411 | 0.782903 | 0.831328 | 0.43127  | 0.657162 |

